import{ax as p,t as m,u as h,v as a,C as r,j as t,B as _,z as n,y as i,aC as g,ay as k,az as Q,F as C,x as y}from"./index.2867131f.js";import{Q as u,a as o}from"./QItem.bc4d8f43.js";import{Q as v}from"./QBadge.46b879fb.js";import{Q as w}from"./QItemLabel.4ff9efae.js";import{Q as O}from"./QList.8dcb108f.js";import{Q as V}from"./QMarkupTable.8ff42f9e.js";import{Q as D}from"./QPage.707a3e00.js";import{u as B,d as N}from"./cart.ee816eed.js";import{u as q}from"./auth.d67a04fa.js";import{api as S}from"./axios.780e8d47.js";import{_ as U}from"./plugin-vue_export-helper.21dcd24c.js";const b=B(),L={name:"OrderDetailPage",data(){return{id:this.$route.params.no,data:[],orders:[],editable:[]}},async mounted(){await S.get(`/api/v1/get_order_detail?user_id=${q().getUid}&order_id=${this.$route.params.no}`).then(d=>{console.log(d),this.data=d.data,this.orders=this.formateList(this.$route.params.no,d.data),this.editable={name:d.data.contact_name,phone:d.data.contact_phone,remark:d.data.remark}})},methods:{formateList(d,l){const x=l.data,f=[];for(let e of x)f.push({sn_id:e.lot_id?e.lot_id:e.product_id,sn:e.lot_id?e.lot_id:e.product_id,amount:e.product_qty,name:e.lot_name?e.lot_name:e.product_name,description:e.product_description,price:e.price_unit,warehouse_id:l.warehouse_id,warehouse_name:l.warehouse_name});return f},stateBadge(d){return d===1?"red":"blue"},convertTimestamp(d){return N.formatDate(d*1e3,"YYYY/MM/DD")},confirmedOrder(){b.confirmOrder(this.data.no),p.create({message:"Order Confirmed",color:"blue"})},cancelOrder(){b.cancelOrder(this.data.no),p.create({message:"Order Canceled",color:"red"})},updateOrder(){this.data.contactDetail=this.editable,this.data.contact=`${this.editable.name}/${this.editable.tel}`,b.updateOrder(this.data.no,this.data),p.create({message:"Detail Updated",color:"green"})},checkPrice(d){return d?`USD$${d}`:"--"}}},P={class:"full-width",style:{"max-width":"1200px"}},M={class:"q-my-md flex"},T={class:"text-h4 q-ml-md"},I=r("thead",null,[r("tr",null,[r("th",{class:"text-left",width:"100"},"SN No."),r("th",{class:"text-left",width:"200"},"Name"),r("th",{class:"text-left"},"Description"),r("th",{class:"text-right",width:"150"},"Price (USD)"),r("th",{class:"text-right",width:"100"},"Qty.")])],-1),Y={class:"text-left"},j={class:"text-left"},z={class:"text-left"},F=["innerHTML"],H={class:"text-right"},A={class:"text-right"},E={class:"row q-gutter-md q-my-md"};function R(d,l,x,f,e,c){return m(),h(D,{padding:"",class:"flex justify-center"},{default:a(()=>[r("div",P,[r("div",M,[t(_,{icon:"arrow_back_ios",color:"primary",label:"Back",onClick:l[0]||(l[0]=s=>d.$router.go(-1))}),r("span",T,"#"+n(e.id),1)]),t(O,{bordered:"",separator:""},{default:a(()=>[t(u,null,{default:a(()=>[t(o,null,{default:a(()=>[i("Warehouse: ")]),_:1}),t(o,{side:""},{default:a(()=>[i(n(e.data.warehouse_name)+" ("+n(e.data.warehouse_id)+")",1)]),_:1})]),_:1}),t(u,null,{default:a(()=>[t(o,null,{default:a(()=>[i("Date: ")]),_:1}),t(o,{side:""},{default:a(()=>[i(n(e.data.create_date),1)]),_:1})]),_:1}),t(u,null,{default:a(()=>[t(o,null,{default:a(()=>[i("Status: ")]),_:1}),t(o,{side:""},{default:a(()=>[t(v,{class:"q-pa-sm"},{default:a(()=>[i(n(e.data.status),1)]),_:1})]),_:1})]),_:1}),t(u,null,{default:a(()=>[t(o,null,{default:a(()=>[i("Contact Name: ")]),_:1}),t(o,{side:""},{default:a(()=>[t(g,{filled:"",modelValue:e.editable.name,"onUpdate:modelValue":l[1]||(l[1]=s=>e.editable.name=s),dense:""},null,8,["modelValue"])]),_:1})]),_:1}),t(u,null,{default:a(()=>[t(o,null,{default:a(()=>[i("Contact Phone: ")]),_:1}),t(o,{side:""},{default:a(()=>[t(g,{filled:"",modelValue:e.editable.phone,"onUpdate:modelValue":l[2]||(l[2]=s=>e.editable.phone=s),dense:"",class:"align-right"},null,8,["modelValue"])]),_:1})]),_:1}),t(u,null,{default:a(()=>[t(o,null,{default:a(()=>[t(w,null,{default:a(()=>[i("Remark:")]),_:1}),t(w,null,{default:a(()=>[t(g,{class:"q-my-sm",filled:"",modelValue:e.editable.remark,"onUpdate:modelValue":l[3]||(l[3]=s=>e.editable.remark=s),dense:"",type:"textarea"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),t(V,{flat:"",bordered:"",separator:"cell",class:"q-my-md"},{default:a(()=>[I,r("tbody",null,[(m(!0),k(C,null,Q(e.orders,s=>(m(),k("tr",{key:s},[r("td",Y,"#"+n(s.sn_id),1),r("td",j,n(s.name),1),r("td",z,[r("div",{innerHTML:s.description},null,8,F)]),r("td",H,n(c.checkPrice(s.price)),1),r("td",A,n(s.amount),1)]))),128))])]),_:1}),r("div",E,[e.data.status==="reserve"?(m(),h(_,{key:0,class:"col",color:"blue",label:"Confirm",onClick:l[4]||(l[4]=s=>c.confirmedOrder())})):y("",!0),e.data.status==="reserve"?(m(),h(_,{key:1,class:"col",color:"red",label:"Cancel",onClick:l[5]||(l[5]=s=>c.cancelOrder())})):y("",!0),t(_,{class:"col",color:"green",label:"Update",onClick:l[6]||(l[6]=s=>c.updateOrder())})])])]),_:1})}var re=U(L,[["render",R]]);export{re as default};
