import{ax as f,u as m,v as h,x as a,y as s,j as t,Q as p,A as d,z as l,C as k,ay as x,az as y,F as Q,b9 as w}from"./index.8e39932e.js";import{Q as u,a as i}from"./QItem.87d750a5.js";import{Q as C}from"./QBadge.485da644.js";import{Q as v}from"./QItemLabel.a967efb7.js";import{Q as D}from"./QList.3f7f1cde.js";import{Q as O}from"./QMarkupTable.86482133.js";import{Q as N}from"./QPage.7323a822.js";import{u as q,d as B}from"./cart.09103fbd.js";import{u as L}from"./auth.6b626beb.js";import{api as P}from"./axios.87b0f64a.js";import{u as S}from"./preference.8c5d01e0.js";import{_ as T}from"./plugin-vue_export-helper.21dcd24c.js";const g=q(),M=S(),W={name:"OrderDetailPage",setup(){M.loaderTrigger("pageLoader")},data(){return{id:this.$route.params.no,data:[],orders:[],editable:[]}},async mounted(){await P.get(`/api/v1/get_order_detail?user_id=${L().getUid}&order_id=${this.$route.params.no}`).then(r=>{this.data=r.data,this.orders=this.formateList(this.$route.params.no,r.data),this.editable={name:r.data.contact_name,phone:r.data.contact_phone,remark:r.data.remark}})},methods:{formateList(r,o){const b=o.data,_=[];for(let e of b)_.push({sn_id:e.lot_id?e.lot_id:e.product_id,sn:e.lot_id?e.lot_id:e.product_id,amount:e.product_qty,name:e.lot_name?e.lot_name:e.product_name,description:e.product_description,price:e.price_unit,warehouse_id:o.warehouse_id,warehouse_name:o.warehouse_name});return _},stateBadge(r){return r===1?"red":"blue"},convertTimestamp(r){return B.formatDate(r*1e3,"YYYY/MM/DD")},confirmedOrder(){g.confirmOrder(this.data.no),f.create({message:"Order Confirmed",color:"blue"})},cancelOrder(){g.cancelOrder(this.data.no),f.create({message:"Order Canceled",color:"red"})},updateOrder(){this.data.contactDetail=this.editable,this.data.contact=`${this.editable.name}/${this.editable.tel}`,g.updateOrder(this.data.no,this.data),f.create({message:"Detail Updated",color:"green"})},checkPrice(r){return r?`${r}`:"--"},showWithDefault(r,o="--"){return r===!1?o:r}}},V={class:"full-width",style:{"max-width":"1200px"}},Y={class:"q-my-md flex"},I={class:"text-h4 q-ml-md"},j=s("thead",null,[s("tr",null,[s("th",{class:"text-left",width:"100"},"SN No."),s("th",{class:"text-left",width:"200"},"Name"),s("th",{class:"text-left"},"Description"),s("th",{class:"text-right",width:"150"},"Price"),s("th",{class:"text-right",width:"100"},"Qty.")])],-1),z={class:"text-left"},A={class:"text-left"},F={class:"text-left"},H=["innerHTML"],U={class:"text-right"},E={class:"text-right"},R={class:"row q-gutter-md q-my-md"};function G(r,o,b,_,e,c){return m(),h(N,{padding:"",class:"flex justify-center"},{default:a(()=>[s("div",V,[s("div",Y,[t(p,{icon:"arrow_back_ios",color:"primary",label:"Back",onClick:o[0]||(o[0]=n=>r.$router.go(-1))}),s("span",I,"#"+d(e.id),1)]),t(D,{bordered:"",separator:""},{default:a(()=>[t(u,null,{default:a(()=>[t(i,null,{default:a(()=>[l("Warehouse: ")]),_:1}),t(i,{side:""},{default:a(()=>[l(d(e.data.warehouse_name)+" ("+d(e.data.warehouse_id)+")",1)]),_:1})]),_:1}),t(u,null,{default:a(()=>[t(i,null,{default:a(()=>[l("Date: ")]),_:1}),t(i,{side:""},{default:a(()=>[l(d(e.data.create_date),1)]),_:1})]),_:1}),t(u,null,{default:a(()=>[t(i,null,{default:a(()=>[l("Status: ")]),_:1}),t(i,{side:""},{default:a(()=>[t(C,{class:"q-pa-sm"},{default:a(()=>[l(d(e.data.status),1)]),_:1})]),_:1})]),_:1}),t(u,null,{default:a(()=>[t(i,null,{default:a(()=>[l("Contact Name: ")]),_:1}),t(i,{side:""},{default:a(()=>[l(d(c.showWithDefault(e.editable.name)),1)]),_:1})]),_:1}),t(u,null,{default:a(()=>[t(i,null,{default:a(()=>[l("Contact Phone: ")]),_:1}),t(i,{side:""},{default:a(()=>[l(d(c.showWithDefault(e.editable.phone)),1)]),_:1})]),_:1}),t(u,null,{default:a(()=>[t(i,null,{default:a(()=>[t(v,null,{default:a(()=>[l("Remark:")]),_:1}),t(k,{class:"q-my-sm"}),l(" "+d(c.showWithDefault(e.editable.remark)),1)]),_:1})]),_:1})]),_:1}),t(O,{flat:"",bordered:"",separator:"cell",class:"q-my-md"},{default:a(()=>[j,s("tbody",null,[(m(!0),x(Q,null,y(e.orders,n=>(m(),x("tr",{key:n},[s("td",z,"#"+d(n.sn_id),1),s("td",A,d(n.name),1),s("td",F,[s("div",{innerHTML:n.description},null,8,H)]),s("td",U,d(c.checkPrice(n.price)),1),s("td",E,d(n.amount),1)]))),128))])]),_:1}),s("div",R,[e.data.status==="reserve"?(m(),h(p,{key:0,class:"col",color:"blue",label:"Confirm",onClick:o[1]||(o[1]=n=>c.confirmedOrder())})):w("",!0),e.data.status==="reserve"?(m(),h(p,{key:1,class:"col",color:"red",label:"Cancel",onClick:o[2]||(o[2]=n=>c.cancelOrder())})):w("",!0)])])]),_:1})}var le=T(W,[["render",G]]);export{le as default};
