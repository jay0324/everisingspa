import{ax as h,x as m,y as p,z as a,A as s,l as t,Q as g,C as l,B as d,G as w,ay as x,az as y,F as Q,aL as b}from"./index.becb7b7f.js";import{Q as u,a as o}from"./QItem.5f839251.js";import{Q as D}from"./QBadge.6fd34590.js";import{Q as C}from"./QItemLabel.380afe55.js";import{Q as O}from"./QList.6a9696f9.js";import{Q as N}from"./QMarkupTable.5ecf006c.js";import{Q as S}from"./QPage.1a56325f.js";import{u as v,d as B}from"./cart.e2d969af.js";import{a as L,u as q}from"./axios.0f3454b4.js";import{u as P}from"./preference.03bb9f57.js";import{_ as T}from"./plugin-vue_export-helper.21dcd24c.js";const f=v(),M=P(),W={name:"OrderDetailPage",setup(){return M.loaderTrigger("pageLoader"),{cart:f}},data(){return{id:this.$route.params.no,data:[],orders:[],editable:[]}},async mounted(){await L.get(`/api/v1/get_order_detail?user_id=${q().getUid}&order_id=${this.$route.params.no}`).then(r=>{this.data=r.data,this.orders=this.formateList(this.$route.params.no,r.data),this.editable={name:r.data.contact_name,phone:r.data.contact_phone,remark:r.data.remark}})},methods:{formateList(r,i){const k=i.data,_=[];for(let e of k)_.push({sn_id:e.lot_id?e.lot_id:e.product_id,sn:e.lot_id?e.lot_id:e.product_id,amount:e.product_qty,name:e.lot_name?e.lot_name:e.product_name,description:e.product_description,price:e.price_unit,warehouse_id:i.warehouse_id,warehouse_name:i.warehouse_name});return _},stateBadge(r){return r===1?"red":"blue"},convertTimestamp(r){return B.formatDate(r*1e3,"YYYY/MM/DD")},confirmedOrder(){f.confirmOrder(this.data.no),h.create({message:"Order Confirmed",color:"blue"})},cancelOrder(){f.cancelOrder(this.data.no),h.create({message:"Order Canceled",color:"red"})},updateOrder(){this.data.contactDetail=this.editable,this.data.contact=`${this.editable.name}/${this.editable.tel}`,f.updateOrder(this.data.no,this.data),h.create({message:"Detail Updated",color:"green"})},checkPrice(r){return r?`${r}`:"--"},showWithDefault(r,i="--"){return r===!1?i:r},checkDate(r){return r?`${r}`:"--"},formateOrderNo(r){return`#S${r.padStart(5,"0")}`}}},V={class:"full-width",style:{"max-width":"1200px"}},Y={class:"q-my-md flex"},I={class:"text-h4 q-ml-md"},z=s("thead",null,[s("tr",null,[s("th",{class:"text-left",width:"100"},"SN No."),s("th",{class:"text-left",width:"200"},"Name"),s("th",{class:"text-left"},"Description"),s("th",{class:"text-right",width:"150"},"Price"),s("th",{class:"text-right",width:"100"},"Qty.")])],-1),A={class:"text-left"},F={class:"text-left"},H={class:"text-left"},U=["innerHTML"],j={class:"text-right"},E={class:"text-right"},G={class:"row q-gutter-md q-my-md"};function R(r,i,k,_,e,n){return m(),p(S,{padding:"",class:"flex justify-center"},{default:a(()=>[s("div",V,[s("div",Y,[t(g,{icon:"arrow_back_ios",color:"primary",label:"Back",onClick:i[0]||(i[0]=c=>r.$router.go(-1))}),s("span",I,l(n.formateOrderNo(e.id)),1)]),t(O,{bordered:"",separator:""},{default:a(()=>[t(u,null,{default:a(()=>[t(o,null,{default:a(()=>[d("Warehouse: ")]),_:1}),t(o,{side:""},{default:a(()=>[d(l(e.data.warehouse_name)+" ("+l(e.data.warehouse_id)+")",1)]),_:1})]),_:1}),t(u,null,{default:a(()=>[t(o,null,{default:a(()=>[d("Date: ")]),_:1}),t(o,{side:""},{default:a(()=>[d(l(n.checkDate(e.data.create_date)),1)]),_:1})]),_:1}),t(u,null,{default:a(()=>[t(o,null,{default:a(()=>[d("Shipping date: ")]),_:1}),t(o,{side:""},{default:a(()=>[d(l(n.checkDate(e.data.scheduled_date)),1)]),_:1})]),_:1}),t(u,null,{default:a(()=>[t(o,null,{default:a(()=>[d("Status: ")]),_:1}),t(o,{side:""},{default:a(()=>[t(D,{class:"q-pa-sm",color:_.cart.statusBadgeColor[e.data.status]},{default:a(()=>[d(l(e.data.status),1)]),_:1},8,["color"])]),_:1})]),_:1}),t(u,null,{default:a(()=>[t(o,null,{default:a(()=>[d("Contact Name: ")]),_:1}),t(o,{side:""},{default:a(()=>[d(l(n.showWithDefault(e.editable.name)),1)]),_:1})]),_:1}),t(u,null,{default:a(()=>[t(o,null,{default:a(()=>[d("Contact Phone: ")]),_:1}),t(o,{side:""},{default:a(()=>[d(l(n.showWithDefault(e.editable.phone)),1)]),_:1})]),_:1}),t(u,null,{default:a(()=>[t(o,null,{default:a(()=>[t(C,null,{default:a(()=>[d("Remark:")]),_:1}),t(w,{class:"q-my-sm"}),d(" "+l(n.showWithDefault(e.editable.remark)),1)]),_:1})]),_:1})]),_:1}),t(N,{flat:"",bordered:"",separator:"cell",class:"q-my-md"},{default:a(()=>[z,s("tbody",null,[(m(!0),x(Q,null,y(e.orders,c=>(m(),x("tr",{key:c},[s("td",A,"#"+l(c.sn_id),1),s("td",F,l(c.name),1),s("td",H,[s("div",{innerHTML:c.description},null,8,U)]),s("td",j,l(n.checkPrice(c.price)),1),s("td",E,l(c.amount),1)]))),128))])]),_:1}),s("div",G,[e.data.status==="reserve"?(m(),p(g,{key:0,class:"col",color:"blue",label:"Confirm",onClick:i[1]||(i[1]=c=>n.confirmedOrder())})):b("",!0),e.data.status==="reserve"?(m(),p(g,{key:1,class:"col",color:"red",label:"Cancel",onClick:i[2]||(i[2]=c=>n.cancelOrder())})):b("",!0)])])]),_:1})}var le=T(W,[["render",R]]);export{le as default};
