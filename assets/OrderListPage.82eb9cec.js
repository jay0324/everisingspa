import{k as I,G as j,I as H,c as F,h as g,l as k,g as U,r as w,ag as z,aO as Y,aP as G,o as K,b5 as W,L as R,N as $,ac as J,b6 as X,b7 as Z,ax as ee,u as h,v as S,x as T,ay as _,j as d,Q as b,y as t,z as L,A as y,F as M,az as E,C as te,aD as C,aC as se,b8 as oe}from"./index.8e39932e.js";import{Q as ae}from"./QMarkupTable.86482133.js";import{Q as re}from"./QPage.7323a822.js";import{u as ne,d as le}from"./cart.09103fbd.js";import{u as ie}from"./auth.6b626beb.js";import{u as ce}from"./preference.8c5d01e0.js";import{_ as de}from"./plugin-vue_export-helper.21dcd24c.js";import"./axios.87b0f64a.js";var ue=I({name:"QBanner",props:{...j,inlineActions:Boolean,dense:Boolean,rounded:Boolean},setup(s,{slots:a}){const{proxy:{$q:p}}=U(),i=H(s,p),n=F(()=>"q-banner row items-center"+(s.dense===!0?" q-banner--dense":"")+(i.value===!0?" q-banner--dark q-dark":"")+(s.rounded===!0?" rounded-borders":"")),l=F(()=>`q-banner__actions row items-center justify-end col-${s.inlineActions===!0?"auto":"all"}`);return()=>{const e=[g("div",{class:"q-banner__avatar col-auto row items-center self-start"},k(a.avatar)),g("div",{class:"q-banner__content col text-body2"},k(a.default))],m=k(a.action);return m!==void 0&&e.push(g("div",{class:l.value},m)),g("div",{class:n.value+(s.inlineActions===!1&&m!==void 0?" q-banner--top-padding":""),role:"alert"},e)}}}),me=I({name:"QForm",props:{autofocus:Boolean,noErrorFocus:Boolean,noResetFocus:Boolean,greedy:Boolean,onSubmit:Function},emits:["reset","validationSuccess","validationError"],setup(s,{slots:a,emit:p}){const i=U(),n=w(null);let l=0;const e=[];function m(o){const v=typeof o=="boolean"?o:s.noErrorFocus!==!0,q=++l,B=(r,c)=>{p(`validation${r===!0?"Success":"Error"}`,c)},O=r=>{const c=r.validate();return typeof c.then=="function"?c.then(f=>({valid:f,comp:r}),f=>({valid:!1,comp:r,err:f})):Promise.resolve({valid:c,comp:r})};return(s.greedy===!0?Promise.all(e.map(O)).then(r=>r.filter(c=>c.valid!==!0)):e.reduce((r,c)=>r.then(()=>O(c).then(f=>{if(f.valid===!1)return Promise.reject(f)})),Promise.resolve()).catch(r=>[r])).then(r=>{if(r===void 0||r.length===0)return q===l&&B(!0),!0;if(q===l){const{comp:c,err:f}=r[0];if(f!==void 0&&console.error(f),B(!1,c),v===!0){const Q=r.find(({comp:A})=>typeof A.focus=="function"&&W(A.$)===!1);Q!==void 0&&Q.comp.focus()}}return!1})}function V(){l++,e.forEach(o=>{typeof o.resetValidation=="function"&&o.resetValidation()})}function D(o){o!==void 0&&R(o);const v=l+1;m().then(q=>{v===l&&q===!0&&(s.onSubmit!==void 0?p("submit",o):o!==void 0&&o.target!==void 0&&typeof o.target.submit=="function"&&o.target.submit())})}function P(o){o!==void 0&&R(o),p("reset"),$(()=>{V(),s.autofocus===!0&&s.noResetFocus!==!0&&x()})}function x(){J(()=>{if(n.value===null)return;const o=n.value.querySelector("[autofocus][tabindex], [data-autofocus][tabindex]")||n.value.querySelector("[autofocus] [tabindex], [data-autofocus] [tabindex]")||n.value.querySelector("[autofocus], [data-autofocus]")||Array.prototype.find.call(n.value.querySelectorAll("[tabindex]"),v=>v.tabIndex!==-1);o!=null&&o.focus({preventScroll:!0})})}z(X,{bindComponent(o){e.push(o)},unbindComponent(o){const v=e.indexOf(o);v!==-1&&e.splice(v,1)}});let N=!1;return Y(()=>{N=!0}),G(()=>{N===!0&&s.autofocus===!0&&x()}),K(()=>{s.autofocus===!0&&x()}),Object.assign(i.proxy,{validate:m,resetValidation:V,submit:D,reset:P,focus:x,getValidationComponents:()=>e}),()=>g("form",{class:"q-form",ref:n,onSubmit:D,onReset:P},k(a.default))}});const u=ne(),{lists:fe,total:he}=Z(u);ie();const ve=ce(),ye={name:"OrderListPage",setup(){return ve.loaderTrigger("pageLoader"),{orderType:u.defaultOrderType,type:w("inquiry"),cart:u,lists:fe,total:he}},data(){return{message:"",contactName:w(null),contactTel:w(null),success:!1}},mounted(){setTimeout(()=>{u.initCartLists()},500)},methods:{availableAmount(s){return u.availableAmount(s)},arriveDate(s){return u.arriveDate(s)},onReset(){this.$refs.myForm.resetValidation(),this.reset(),u.clearLists()},onSubmit(){this.$refs.myForm.validate().then(s=>{if(s)return this.submitOrder()}).then(s=>{this.success=!0,ee.create({message:"Order Created",color:"blue"})})},reset(){this.orderType=u.defaultOrderType,this.message="",this.contactName="",this.contactTel=""},submitOrder(){let s=`${le.formatDate(Date.now(),"YYYYMMDDHHmmss")}`;return u.saveOrder({no:s,state:0,type:this.orderType,location:1,contact:`${this.contactName}/${this.contactTel}`,method:s,date:{order:this.getTimestamp()},contactDetail:{name:this.contactName,tel:this.contactTel,message:this.message},order:u.lists})},getTimestamp(){return Math.round(+new Date/1e3)},checkPrice(s){return s?`USD$${s}`:"--"},errorMessages(){this.$refs.contact_name.validate(),this.$refs.contact_phone.validate()}}},pe={key:0},be=t("h3",null,"Success",-1),_e={key:1,class:"full-width",style:{"max-width":"1200px"}},ge=t("h2",null,"Order List",-1),xe={class:"text-center flex flex-center q-my-xl"},qe={class:"q-gutter-md full-width text-left"},Se=t("strong",{class:"q-pa-sm"},"Warehouse:",-1),Te=t("strong",{class:"q-pa-sm"},"Type:",-1),ke=t("thead",null,[t("tr",null,[t("th",{class:"text-left",width:"100"},"SN"),t("th",{class:"text-left",width:"200"},"Name"),t("th",{class:"text-left"},"description"),t("th",{class:"text-right",width:"150"},"Price (USD)"),t("th",{class:"text-right",width:"100"},"Stock Amount"),t("th",{class:"text-right",width:"150"},"Scheduled Date"),t("th",{class:"text-right",width:"100"},"Qty."),t("th",{class:"text-right",width:"20"},"Delete")])],-1),we={class:"text-left"},Ce={class:"text-left"},Ve={class:"text-left"},De=["innerHTML"],Pe={class:"text-right"},Ne={class:"text-right"},Be={class:"text-right"},Oe={class:"text-right"},Qe=t("div",{class:"q-pa-md"}," No products have been added yet. Please select a product to add. ",-1),Ae={class:"text-center flex flex-center q-my-xl"},Fe={class:"q-pa-md flex"},Re=t("strong",{class:"q-pa-sm"},"Type:",-1),Le={class:"q-gutter-sm"},Me={class:"row q-gutter-md q-my-md"};function Ee(s,a,p,i,n,l){return h(),S(re,{padding:"",class:"flex justify-center items-center"},{default:T(()=>[n.success?(h(),_("div",pe,[be,d(b,{to:"order_history",label:"Go to Order History"})])):(h(),_("div",_e,[ge,t("div",xe,[t("div",qe,[Se,L(" "+y(i.cart.warehouse_name)+" ",1),Te,L(" "+y(i.cart.warehouse_type),1)])]),i.cart.lists.length>0?(h(),S(ae,{key:0,bordered:"",separator:"cell"},{default:T(()=>[ke,t("tbody",null,[(h(!0),_(M,null,E(i.lists,e=>(h(),_("tr",{key:e},[t("td",we,"#"+y(e.sn),1),t("td",Ce,y(e.name),1),t("td",Ve,[t("div",{innerHTML:e.description},null,8,De)]),t("td",Pe,y(l.checkPrice(e.price)),1),t("td",Ne,y(l.arriveDate(e.sn)),1),t("td",Be,y(e.amount),1),t("td",Oe,[d(b,{color:"grey",round:"",icon:"delete",onClick:se(m=>i.cart.removeItem(e.id),["prevent"])},null,8,["onClick"])])]))),128))])]),_:1})):(h(),S(ue,{key:1,rounded:"",class:"bg-red text-white text-center"},{default:T(()=>[Qe,d(b,{color:"primary",to:"/products",label:"choose products"})]),_:1})),d(te,{color:"primary",class:"q-mt-xl"}),t("div",Ae,[d(me,{ref:"myForm",class:"q-gutter-md full-width text-left",onSubmit:a[4]||(a[4]=e=>l.onSubmit()),onReset:a[5]||(a[5]=e=>l.onReset()),onValidationError:a[6]||(a[6]=e=>l.errorMessages())},{default:T(()=>[t("div",Fe,[Re,t("div",null,[t("div",Le,[(h(!0),_(M,null,E(i.cart.typeOption,e=>(h(),S(oe,{modelValue:i.orderType,"onUpdate:modelValue":a[0]||(a[0]=m=>i.orderType=m),val:e.value,label:e.label,key:e},null,8,["modelValue","val","label"]))),128))])])]),d(C,{ref:"contact_name",outlined:"",modelValue:n.contactName,"onUpdate:modelValue":a[1]||(a[1]=e=>n.contactName=e),label:"Contact Name:","lazy-rules":"",rules:[e=>e&&e.length>0||"Required"]},null,8,["modelValue","rules"]),d(C,{ref:"contact_phone",outlined:"",modelValue:n.contactTel,"onUpdate:modelValue":a[2]||(a[2]=e=>n.contactTel=e),label:"Contact Phone:","lazy-rules":"",rules:[e=>e&&e.length>0||"Required"]},null,8,["modelValue","rules"]),d(C,{modelValue:n.message,"onUpdate:modelValue":a[3]||(a[3]=e=>n.message=e),outlined:"",label:"Note:",type:"textarea"},null,8,["modelValue"]),t("div",Me,[d(b,{class:"col",label:"Clear Cart",color:"grey",type:"reset"}),d(b,{class:"col",label:"Choose Products",color:"teal",to:"products"}),d(b,{class:"col",label:"Submit",color:"blue",type:"submit"})])]),_:1},512)])]))]),_:1})}var $e=de(ye,[["render",Ee]]);export{$e as default};
