import{ax as h,x as m,y as p,z as a,A as s,l as t,Q as g,C as l,B as d,G as y,ay as x,az as Q,F as D,aL as b}from"./index.1f5286ed.js";import{Q as u,a as o}from"./QItem.f374faa7.js";import{Q as O}from"./QBadge.13615ff0.js";import{Q as C}from"./QItemLabel.a268c350.js";import{Q as N}from"./QList.87b70711.js";import{Q as S}from"./QMarkupTable.670ba71e.js";import{Q as v}from"./QPage.5162f531.js";import{u as B,d as L}from"./cart.5402cc7e.js";import{a as q,u as w}from"./axios.a6636192.js";import{u as P}from"./preference.07cb40f5.js";import{_ as T}from"./plugin-vue_export-helper.21dcd24c.js";const f=B(),M=P(),W={name:"OrderDetailPage",setup(){return M.loaderTrigger("pageLoader"),{cart:f}},data(){return{id:this.$route.params.no,data:[],orders:[],editable:[]}},async mounted(){await q.get(`/api/v1/get_order_detail?user_id=${w().getUid}&order_id=${this.$route.params.no}`,{headers:{GTTOKEN:w().apiKey}}).then(r=>{this.data=r.data,this.orders=this.formateList(this.$route.params.no,r.data),this.editable={name:r.data.contact_name,phone:r.data.contact_phone,remark:r.data.remark}})},methods:{formateList(r,i){const k=i.data,_=[];for(let e of k)_.push({sn_id:e.lot_id?e.lot_id:e.product_id,sn:e.lot_id?e.lot_id:e.product_id,amount:e.product_qty,name:e.lot_name?e.lot_name:e.product_name,description:e.product_description,price:e.price_unit,warehouse_id:i.warehouse_id,warehouse_name:i.warehouse_name});return _},stateBadge(r){return r===1?"red":"blue"},convertTimestamp(r){return L.formatDate(r*1e3,"YYYY/MM/DD")},confirmedOrder(){f.confirmOrder(this.data.no),h.create({message:"Order Confirmed",color:"blue"})},cancelOrder(){f.cancelOrder(this.data.no),h.create({message:"Order Canceled",color:"red"})},updateOrder(){this.data.contactDetail=this.editable,this.data.contact=`${this.editable.name}/${this.editable.tel}`,f.updateOrder(this.data.no,this.data),h.create({message:"Detail Updated",color:"green"})},checkPrice(r){return r?`${r}`:"--"},showWithDefault(r,i="--"){return r===!1?i:r},checkDate(r){return r?`${r}`:"--"},formateOrderNo(r){return`#S${r.padStart(5,"0")}`}}},V={class:"full-width",style:{"max-width":"1200px"}},Y={class:"q-my-md flex"},I={class:"text-h4 q-ml-md"},z=s("thead",null,[s("tr",null,[s("th",{class:"text-left",width:"100"},"SN No."),s("th",{class:"text-left",width:"200"},"Name"),s("th",{class:"text-left"},"Description"),s("th",{class:"text-right",width:"150"},"Price"),s("th",{class:"text-right",width:"100"},"Qty.")])],-1),A={class:"text-left"},E={class:"text-left"},F={class:"text-left"},G=["innerHTML"],H={class:"text-right"},K={class:"text-right"},U={class:"row q-gutter-md q-my-md"};function j(r,i,k,_,e,n){return m(),p(v,{padding:"",class:"flex justify-center"},{default:a(()=>[s("div",V,[s("div",Y,[t(g,{icon:"arrow_back_ios",color:"primary",label:"Back",onClick:i[0]||(i[0]=c=>r.$router.go(-1))}),s("span",I,l(n.formateOrderNo(e.id)),1)]),t(N,{bordered:"",separator:""},{default:a(()=>[t(u,null,{default:a(()=>[t(o,null,{default:a(()=>[d("Warehouse: ")]),_:1}),t(o,{side:""},{default:a(()=>[d(l(e.data.warehouse_name)+" ("+l(e.data.warehouse_id)+")",1)]),_:1})]),_:1}),t(u,null,{default:a(()=>[t(o,null,{default:a(()=>[d("Date: ")]),_:1}),t(o,{side:""},{default:a(()=>[d(l(n.checkDate(e.data.create_date)),1)]),_:1})]),_:1}),t(u,null,{default:a(()=>[t(o,null,{default:a(()=>[d("Shipping date: ")]),_:1}),t(o,{side:""},{default:a(()=>[d(l(n.checkDate(e.data.scheduled_date)),1)]),_:1})]),_:1}),t(u,null,{default:a(()=>[t(o,null,{default:a(()=>[d("Status: ")]),_:1}),t(o,{side:""},{default:a(()=>[t(O,{class:"q-pa-sm",color:_.cart.statusBadgeColor[e.data.status]},{default:a(()=>[d(l(e.data.status),1)]),_:1},8,["color"])]),_:1})]),_:1}),t(u,null,{default:a(()=>[t(o,null,{default:a(()=>[d("Contact Name: ")]),_:1}),t(o,{side:""},{default:a(()=>[d(l(n.showWithDefault(e.editable.name)),1)]),_:1})]),_:1}),t(u,null,{default:a(()=>[t(o,null,{default:a(()=>[d("Contact Phone: ")]),_:1}),t(o,{side:""},{default:a(()=>[d(l(n.showWithDefault(e.editable.phone)),1)]),_:1})]),_:1}),t(u,null,{default:a(()=>[t(o,null,{default:a(()=>[t(C,null,{default:a(()=>[d("Remark:")]),_:1}),t(y,{class:"q-my-sm"}),d(" "+l(n.showWithDefault(e.editable.remark)),1)]),_:1})]),_:1})]),_:1}),t(S,{flat:"",bordered:"",separator:"cell",class:"q-my-md"},{default:a(()=>[z,s("tbody",null,[(m(!0),x(D,null,Q(e.orders,c=>(m(),x("tr",{key:c},[s("td",A,"#"+l(c.sn_id),1),s("td",E,l(c.name),1),s("td",F,[s("div",{innerHTML:c.description},null,8,G)]),s("td",H,l(n.checkPrice(c.price)),1),s("td",K,l(c.amount),1)]))),128))])]),_:1}),s("div",U,[e.data.status==="reserve"?(m(),p(g,{key:0,class:"col",color:"blue",label:"Confirm",onClick:i[1]||(i[1]=c=>n.confirmedOrder())})):b("",!0),e.data.status==="reserve"?(m(),p(g,{key:1,class:"col",color:"red",label:"Cancel",onClick:i[2]||(i[2]=c=>n.cancelOrder())})):b("",!0)])])]),_:1})}var le=T(W,[["render",j]]);export{le as default};
