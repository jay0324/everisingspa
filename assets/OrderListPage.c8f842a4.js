import{k as M,V as U,Z as j,c as A,h as x,l as V,g as I,r as L,ai as H,aO as Y,aP as z,o as K,b5 as G,ad as Q,K as Z,ab as J,b6 as W,b7 as X,au as $,t as m,u as S,v as T,av as p,j as c,B as _,C as t,F as R,aw as E,y as ee,E as te,aD as w,z as y,aC as se,b8 as oe}from"./index.e2d4a23c.js";import{Q as ae}from"./QMarkupTable.ed65abbd.js";import{Q as re}from"./QPage.c244552f.js";import{u as ne}from"./cart.7330fa57.js";import{u as le}from"./auth.4817aac0.js";import{d as ie}from"./date.16ac6d8b.js";import{_ as ce}from"./plugin-vue_export-helper.21dcd24c.js";import"./axios.51180271.js";var ue=M({name:"QBanner",props:{...U,inlineActions:Boolean,dense:Boolean,rounded:Boolean},setup(o,{slots:n}){const{proxy:{$q:b}}=I(),h=j(o,b),a=A(()=>"q-banner row items-center"+(o.dense===!0?" q-banner--dense":"")+(h.value===!0?" q-banner--dark q-dark":"")+(o.rounded===!0?" rounded-borders":"")),l=A(()=>`q-banner__actions row items-center justify-end col-${o.inlineActions===!0?"auto":"all"}`);return()=>{const e=[x("div",{class:"q-banner__avatar col-auto row items-center self-start"},V(n.avatar)),x("div",{class:"q-banner__content col text-body2"},V(n.default))],u=V(n.action);return u!==void 0&&e.push(x("div",{class:l.value},u)),x("div",{class:a.value+(o.inlineActions===!1&&u!==void 0?" q-banner--top-padding":""),role:"alert"},e)}}}),de=M({name:"QForm",props:{autofocus:Boolean,noErrorFocus:Boolean,noResetFocus:Boolean,greedy:Boolean,onSubmit:Function},emits:["reset","validationSuccess","validationError"],setup(o,{slots:n,emit:b}){const h=I(),a=L(null);let l=0;const e=[];function u(s){const v=typeof s=="boolean"?s:o.noErrorFocus!==!0,q=++l,N=(r,i)=>{b(`validation${r===!0?"Success":"Error"}`,i)},O=r=>{const i=r.validate();return typeof i.then=="function"?i.then(d=>({valid:d,comp:r}),d=>({valid:!1,comp:r,err:d})):Promise.resolve({valid:i,comp:r})};return(o.greedy===!0?Promise.all(e.map(O)).then(r=>r.filter(i=>i.valid!==!0)):e.reduce((r,i)=>r.then(()=>O(i).then(d=>{if(d.valid===!1)return Promise.reject(d)})),Promise.resolve()).catch(r=>[r])).then(r=>{if(r===void 0||r.length===0)return q===l&&N(!0),!0;if(q===l){const{comp:i,err:d}=r[0];if(d!==void 0&&console.error(d),N(!1,i),v===!0){const P=r.find(({comp:F})=>typeof F.focus=="function"&&G(F.$)===!1);P!==void 0&&P.comp.focus()}}return!1})}function C(){l++,e.forEach(s=>{typeof s.resetValidation=="function"&&s.resetValidation()})}function k(s){s!==void 0&&Q(s);const v=l+1;u().then(q=>{v===l&&q===!0&&(o.onSubmit!==void 0?b("submit",s):s!==void 0&&s.target!==void 0&&typeof s.target.submit=="function"&&s.target.submit())})}function D(s){s!==void 0&&Q(s),b("reset"),Z(()=>{C(),o.autofocus===!0&&o.noResetFocus!==!0&&g()})}function g(){J(()=>{if(a.value===null)return;const s=a.value.querySelector("[autofocus][tabindex], [data-autofocus][tabindex]")||a.value.querySelector("[autofocus] [tabindex], [data-autofocus] [tabindex]")||a.value.querySelector("[autofocus], [data-autofocus]")||Array.prototype.find.call(a.value.querySelectorAll("[tabindex]"),v=>v.tabIndex!==-1);s!=null&&s.focus({preventScroll:!0})})}H(W,{bindComponent(s){e.push(s)},unbindComponent(s){const v=e.indexOf(s);v!==-1&&e.splice(v,1)}});let B=!1;return Y(()=>{B=!0}),z(()=>{B===!0&&o.autofocus===!0&&g()}),K(()=>{o.autofocus===!0&&g()}),Object.assign(h.proxy,{validate:u,resetValidation:C,submit:k,reset:D,focus:g,getValidationComponents:()=>e}),()=>x("form",{class:"q-form",ref:a,onSubmit:k,onReset:D},V(n.default))}});const f=ne(),{lists:me,total:fe}=X(f);le();const he={name:"OrderListPage",setup(){return{type:L("reserved"),cart:f,lists:me,total:fe}},data(){return{orderType:f.defaultOrderType,message:"",contactName:"",contactTel:"",success:!1}},methods:{availableAmount(o){return f.availableAmount(o)},arriveDate(o){return f.arriveDate(o)},onReset(){this.$refs.myForm.resetValidation(),this.reset(),f.clearLists()},onSubmit(){this.$refs.myForm.validate().then(o=>this.submitOrder()).then(o=>{this.success=!0,$.create({message:"Order Created",color:"blue"})})},reset(){this.orderType=f.defaultOrderType,this.message="",this.contactName="",this.contactTel=""},submitOrder(){let o=`${ie.formatDate(Date.now(),"YYYYMMDDHHmmss")}`;return f.saveOrder({no:o,state:0,type:this.orderType,location:1,contact:`${this.contactName}/${this.contactTel}`,method:o,date:{order:this.getTimestamp()},contactDetail:{name:this.contactName,tel:this.contactTel,message:this.message},order:f.lists})},getTimestamp(){return Math.round(+new Date/1e3)}}},ve={key:0},be=t("h3",null,"Success",-1),ye={key:1,class:"full-width",style:{"max-width":"1200px"}},pe=t("h2",null,"Order List",-1),_e=t("thead",null,[t("tr",null,[t("th",{class:"text-left",width:"100"},"\u7522\u54C1SN"),t("th",{class:"text-left",width:"200"},"\u7522\u54C1\u540D\u7A31"),t("th",{class:"text-left"},"\u7522\u54C1\u63CF\u8FF0"),t("th",{class:"text-right",width:"150"},"\u7522\u54C1\u50F9\u683C (USD)"),t("th",{class:"text-right",width:"100"},"\u53EF\u4E0B\u55AE\u6578\u91CF"),t("th",{class:"text-right",width:"150"},"\u6700\u5FEB\u5230\u6E2F\u65E5\u671F"),t("th",{class:"text-right",width:"100"},"\u6578\u91CF"),t("th",{class:"text-right",width:"20"},"\u522A\u9664")])],-1),xe={class:"text-left"},ge={class:"text-left"},qe={class:"text-left"},Se=["innerHTML"],Te={class:"text-right"},Ve={class:"text-right"},we={class:"text-right"},Ce={class:"text-right"},ke={class:"text-right"},De={class:"text-center flex flex-center q-my-xl"},Be={class:"q-pa-md flex"},Ne=t("strong",{class:"q-pa-sm"},"Type:",-1),Oe={class:"q-gutter-sm"},Pe={class:"row q-gutter-md q-my-md"};function Fe(o,n,b,h,a,l){return m(),S(re,{padding:"",class:"flex justify-center items-center"},{default:T(()=>[a.success?(m(),p("div",ve,[be,c(_,{to:"order_history",label:"Go to Order History"})])):(m(),p("div",ye,[pe,h.cart.lists.length>0?(m(),S(ae,{key:0,bordered:"",separator:"cell"},{default:T(()=>[_e,t("tbody",null,[(m(!0),p(R,null,E(h.lists,e=>(m(),p("tr",{key:e},[t("td",xe,"#"+y(e.sn),1),t("td",ge,y(e.name),1),t("td",qe,[t("div",{innerHTML:e.description},null,8,Se)]),t("td",Te,"USD$"+y(e.price),1),t("td",Ve,y(l.availableAmount(e.sn)),1),t("td",we,y(l.arriveDate(e.sn)),1),t("td",Ce,y(e.amount),1),t("td",ke,[c(_,{color:"grey",round:"",icon:"delete",onClick:se(u=>h.cart.removeItem(e.sn_id),["prevent"])},null,8,["onClick"])])]))),128))])]),_:1})):(m(),S(ue,{key:1,rounded:"",class:"bg-red text-white text-center"},{default:T(()=>[ee(" No Items ")]),_:1})),c(te,{color:"primary",class:"q-mt-xl"}),t("div",De,[c(de,{ref:"myForm",class:"q-gutter-md full-width text-left",onSubmit:l.onSubmit,onReset:l.onReset},{default:T(()=>[t("div",Be,[Ne,t("div",null,[t("div",Oe,[(m(!0),p(R,null,E(h.cart.typeOption,e=>(m(),S(oe,{modelValue:a.orderType,"onUpdate:modelValue":n[0]||(n[0]=u=>a.orderType=u),val:e.value,label:e.label,key:e},null,8,["modelValue","val","label"]))),128))])])]),c(w,{outlined:"",modelValue:a.contactName,"onUpdate:modelValue":n[1]||(n[1]=e=>a.contactName=e),label:"Contact Name:","lazy-rules":"",rules:[e=>e&&e.length>0||"Required"]},null,8,["modelValue","rules"]),c(w,{outlined:"",modelValue:a.contactTel,"onUpdate:modelValue":n[2]||(n[2]=e=>a.contactTel=e),label:"Contact Phone:","lazy-rules":"",rules:[e=>e&&e.length>0||"Required"]},null,8,["modelValue","rules"]),c(w,{modelValue:a.message,"onUpdate:modelValue":n[3]||(n[3]=e=>a.message=e),outlined:"",label:"Note:",type:"textarea"},null,8,["modelValue"]),t("div",Pe,[c(_,{class:"col",label:"Clear Cart",color:"grey",type:"reset"}),c(_,{class:"col",label:"Choose Products",color:"teal",to:"products"}),c(_,{class:"col",label:"Submit",color:"blue",type:"submit"})])]),_:1},8,["onSubmit","onReset"])])]))]),_:1})}var He=ce(he,[["render",Fe]]);export{He as default};
